<!DOCTYPE html>
<html>
<head>
    <title>Dashboard Load Test</title>
</head>
<body>
    <h1>Beverly Knits Dashboard Data Load Test</h1>
    <button onclick="testDashboard()">Test Dashboard Functions</button>
    <div id="results"></div>
    
    <script>
        const API_BASE = 'http://localhost:5006';
        const resultsDiv = document.getElementById('results');
        
        async function testDashboard() {
            resultsDiv.innerHTML = '<h2>Testing Dashboard APIs...</h2>';
            
            // Test all APIs that the dashboard uses
            const endpoints = [
                '/api/comprehensive-kpis',
                '/api/yarn-intelligence', 
                '/api/inventory-intelligence-enhanced?realtime=true',
                '/api/production-planning',
                '/api/production-pipeline'
            ];
            
            for (const endpoint of endpoints) {
                try {
                    const response = await fetch(API_BASE + endpoint);
                    const data = await response.json();
                    
                    resultsDiv.innerHTML += `<h3>✅ ${endpoint}</h3>`;
                    
                    // Show key data points
                    if (endpoint.includes('comprehensive-kpis')) {
                        resultsDiv.innerHTML += `
                            <ul>
                                <li>Inventory Value: ${data.inventory_value}</li>
                                <li>Total Yarns: ${data.total_yarns}</li>
                                <li>Active Orders: ${data.active_knit_orders}</li>
                                <li>Critical Alerts: ${data.critical_alerts}</li>
                            </ul>
                        `;
                    } else if (endpoint.includes('yarn-intelligence')) {
                        const summary = data.criticality_analysis?.summary || {};
                        resultsDiv.innerHTML += `
                            <ul>
                                <li>Yarns with Shortage: ${summary.yarns_with_shortage}</li>
                                <li>Critical Count: ${summary.critical_count}</li>
                                <li>High Count: ${summary.high_count}</li>
                                <li>Total Shortage: ${(summary.total_shortage_lbs || 0).toFixed(2)} lbs</li>
                            </ul>
                        `;
                    } else if (endpoint.includes('inventory-intelligence')) {
                        resultsDiv.innerHTML += `
                            <ul>
                                <li>Overall Health: ${data.summary?.overall_health}</li>
                                <li>Action Items: ${data.summary?.action_items_count}</li>
                                <li>Yarns with Shortage: ${data.summary?.yarns_with_shortage}</li>
                            </ul>
                        `;
                    }
                    
                } catch (error) {
                    resultsDiv.innerHTML += `<p>❌ ${endpoint}: ${error.message}</p>`;
                }
            }
            
            resultsDiv.innerHTML += '<h2>✅ All APIs accessible - Dashboard should display data!</h2>';
        }
        
        // Auto-run test
        testDashboard();
    </script>
</body>
</html>